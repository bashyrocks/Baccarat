.bonus-info-box {
                margin-top: 15px;
                padding: 12px;
                font-size: 0.85em;
                line-height: 1.5;
            }
            
            .bonus-info-box p {
                margin-bottom: 4px;
            }            .loading {
                padding: 30px;
            }
            
            .spinner {
                width: 60px;
                height: 60px;
                border-width: 4px;
            }        button:focus-visible {
            outline: 2px solid #64B5F6;
            outline-offset: 2px;
        }
        
        input:focus-visible {
            outline: 2px solid #64B5F6;
            outline-offset: 1px;
        }        button {
            touch-action: manipulation;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        button:focus-visible {
            outline: 2px solid #64B5F6;
            outline-offset: 2px;
        }
        
        input {
            touch-action: manipulation;
        }
        
        input:focus-visible {
            outline: 2px solid #64B5F6;
            outline-offset: 1px;
        }<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Baccarat Predictor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }
        
        button {
            touch-action: manipulation;
        }
        
        input {
            touch-action: manipulation;
        }

        html {
            overflow: hidden;
            height: 100%;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a1929 0%, #1e3c72 50%, #2a5298 100%);
            background-attachment: fixed;
            min-height: 100vh;
            min-height: calc(var(--vh, 1vh) * 100);
            color: #fff;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
            height: 100%;
        }
        
        @media (max-width: 768px) {
            html, body {
                overflow-x: hidden;
                width: 100%;
            }
            
            body {
                background-attachment: scroll;
            }
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(52, 152, 219, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(41, 128, 185, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(142, 68, 173, 0.1) 0%, transparent 50%);
            animation: pulse 10s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 0.8s ease;
        }

        .header h1 {
            font-size: 3.5em;
            font-weight: 300;
            letter-spacing: 3px;
            background: linear-gradient(45deg, #64B5F6, #42A5F5, #90CAF9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(100, 181, 246, 0.3);
        }

        /* Main Content Area */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
            animation: fadeIn 1s ease 0.2s both;
        }

        /* Card */
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
        }

        .card h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #64B5F6;
            font-weight: 400;
            letter-spacing: 1px;
        }

        /* Shoe Composition */
        .shoe-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
        }

        .card-input {
            text-align: center;
        }

        .card-label {
            display: block;
            margin-bottom: 8px;
            font-size: 1.2em;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
        }

        .card-label .suit {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.5);
        }

        .card-count {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            text-align: center;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .card-count:focus {
            outline: none;
            border-color: #64B5F6;
            background: rgba(100, 181, 246, 0.1);
            box-shadow: 0 0 20px rgba(100, 181, 246, 0.3);
        }

        /* Simulation Settings */
        .settings-group {
            margin-bottom: 20px;
        }

        .settings-group label {
            display: block;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1em;
        }

        .settings-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .settings-input:focus {
            outline: none;
            border-color: #64B5F6;
            background: rgba(100, 181, 246, 0.1);
        }

        /* Preset Buttons */
        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .preset-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .preset-btn:hover {
            background: rgba(100, 181, 246, 0.2);
            border-color: #64B5F6;
            transform: scale(1.05);
        }

        /* Run Button */
        .run-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #42A5F5, #1E88E5);
            border: none;
            border-radius: 15px;
            color: #fff;
            font-size: 1.3em;
            font-weight: 600;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-top: 30px;
        }

        .run-button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .run-button:hover::after {
            width: 600px;
            height: 600px;
        }

        .run-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(66, 165, 245, 0.4);
        }

        .run-button:active {
            transform: translateY(0);
        }

        /* Results Section */
        .results {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 40px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .results.show {
            opacity: 1;
            transform: translateY(0);
        }

        .results h2 {
            text-align: center;
            font-size: 2em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #64B5F6, #42A5F5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Probability Bars */
        .prob-item {
            margin-bottom: 25px;
        }

        .prob-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .prob-bar-container {
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .prob-bar {
            height: 100%;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            border-radius: 20px;
            width: 0;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .prob-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .prob-bar.player {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
        }

        .prob-bar.tie {
            background: linear-gradient(90deg, #2196F3, #03A9F4);
        }

        /* Game History */
        .history-section {
            margin-top: 30px;
        }
        
        .history-section h3 {
            color: #64B5F6;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .history-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
        }

        .history-input {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
        }

        .history-input:focus {
            outline: none;
            border-color: #64B5F6;
            background: rgba(100, 181, 246, 0.1);
            box-shadow: 0 0 20px rgba(100, 181, 246, 0.3);
        }

        .history-input::placeholder {
            color: rgba(255, 255, 255, 0.3);
            font-size: 0.9em;
            letter-spacing: 1px;
        }

        .quick-input-buttons {
            display: flex;
            gap: 8px;
        }

        .quick-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2em;
        }

        .quick-btn.banker {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 140, 0, 0.2));
            border-color: #FFD700;
        }

        .quick-btn.player {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(139, 195, 74, 0.2));
            border-color: #4CAF50;
        }

        .quick-btn.tie {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.2), rgba(3, 169, 244, 0.2));
            border-color: #2196F3;
        }

        .quick-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .quick-btn:active {
            transform: scale(0.95);
        }

        .history-display {
            margin-top: 20px;
        }

        .history-road {
            display: flex;
            gap: 5px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow-x: auto;
            min-height: 70px;
            align-items: center;
        }

        .history-bead {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3em;
            color: #000;
            flex-shrink: 0;
            position: relative;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            animation: beadPop 0.3s ease;
        }

        @keyframes beadPop {
            0% { transform: scale(0); }
            60% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .history-bead.banker-bead {
            background: linear-gradient(135deg, #FFD700, #FFA500);
        }

        .history-bead.player-bead {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
        }

        .history-bead.tie-bead {
            background: linear-gradient(135deg, #2196F3, #03A9F4);
        }

        .history-bead .index {
            position: absolute;
            top: -8px;
            right: -8px;
            background: rgba(255, 255, 255, 0.9);
            color: #000;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-weight: 600;
        }

        .history-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .history-stat {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-stat .label {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 5px;
        }

        .history-stat .value {
            font-size: 1.5em;
            font-weight: 600;
        }

        .history-stat.banker .value {
            color: #FFD700;
        }

        .history-stat.player .value {
            color: #4CAF50;
        }

        .history-stat.tie .value {
            color: #2196F3;
        }

        .clear-history-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            margin-top: 15px;
        }

        .clear-history-btn:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff4444;
            transform: scale(1.05);
        }

        /* Recommendation */
        .recommendation {
            text-align: center;
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, rgba(100, 181, 246, 0.1), rgba(66, 165, 245, 0.1));
            border-radius: 20px;
            border: 2px solid #64B5F6;
            position: relative;
            overflow: hidden;
        }

        .recommendation::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #64B5F6, #42A5F5, #64B5F6);
            border-radius: 20px;
            opacity: 0.5;
            animation: rotate 3s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .recommendation h3 {
            font-size: 1.3em;
            margin-bottom: 10px;
            color: #64B5F6;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .recommendation .winner {
            font-size: 2.5em;
            font-weight: 700;
            margin: 20px 0;
            text-transform: uppercase;
            letter-spacing: 3px;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px rgba(100, 181, 246, 0.5); }
            50% { text-shadow: 0 0 40px rgba(100, 181, 246, 0.8); }
        }

        .recommendation .details {
            font-size: 1.1em;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }
        
        /* Bonus Predictions */
        .bonus-predictions {
            margin-top: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .bonus-predictions h3 {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 25px;
            color: #64B5F6;
            letter-spacing: 1px;
        }
        
        .bonus-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .bonus-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .bonus-card.hot {
            animation: bonusPulse 2s ease-in-out infinite;
            border-color: #FFD700;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 140, 0, 0.1));
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
        }
        
        @keyframes bonusPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            }
            50% { 
                transform: scale(1.02);
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.5);
            }
        }
        
        @media (max-width: 768px) {
            .bonus-card.hot {
                animation: bonusPulseMobile 2s ease-in-out infinite;
            }
            
            @keyframes bonusPulseMobile {
                0%, 100% { 
                    transform: scale(1);
                    box-shadow: 0 0 25px rgba(255, 215, 0, 0.4);
                }
                25% {
                    transform: scale(1.01) translateX(-1px);
                }
                50% { 
                    transform: scale(1.03);
                    box-shadow: 0 0 45px rgba(255, 215, 0, 0.6);
                }
                75% {
                    transform: scale(1.01) translateX(1px);
                }
            }
        }
        
        .bonus-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .bonus-icon {
            font-size: 2em;
        }
        
        .bonus-name {
            font-size: 1.2em;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .panda .bonus-name {
            color: #4CAF50;
        }
        
        .dragon .bonus-name {
            color: #FF6B6B;
        }
        
        .bonus-indicator {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .indicator-bar {
            height: 100%;
            width: 20%;
            border-radius: 4px;
            transition: all 1s ease;
        }
        
        #panda-bar {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
        }
        
        #dragon-bar {
            background: linear-gradient(90deg, #FF6B6B, #FF8787);
        }
        
        .bonus-info {
            text-align: center;
        }
        
        .bonus-chance {
            display: block;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .bonus-desc {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .bonus-odds {
            display: block;
            font-size: 0.9em;
            color: #FFC107;
            margin: 3px 0;
            font-weight: 500;
        }
        
        .bonus-alert {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 140, 0, 0.2));
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            animation: alertPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes alertPulse {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 1; }
        }
        
        .alert-icon {
            font-size: 1.5em;
            animation: rotate 2s linear infinite;
        }
        
        .alert-text {
            font-size: 1.1em;
            font-weight: 600;
            color: #FFD700;
            letter-spacing: 0.5px;
        }
        
        .bonus-info-box {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        .bonus-info-box p {
            margin-bottom: 5px;
        }
        
        .bonus-info-box strong {
            color: #64B5F6;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from { 
                opacity: 0;
                transform: translateY(-20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-top-color: #64B5F6;
            border-radius: 50%;
            margin: 0 auto;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2.2em;
                letter-spacing: 2px;
            }

            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .card {
                padding: 20px;
                border-radius: 15px;
            }

            .card h2 {
                font-size: 1.3em;
            }
            
            .history-section h3 {
                font-size: 1.2em;
            }

            .shoe-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .card-count {
                padding: 14px;
                font-size: 1.2em;
                min-height: 48px;
                -webkit-appearance: none;
            }

            .settings-input {
                padding: 14px;
                font-size: 1.1em;
                min-height: 48px;
                -webkit-appearance: none;
            }

            .preset-buttons {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .preset-btn {
                padding: 12px 20px;
                font-size: 1em;
                min-height: 44px;
            }

            .run-button {
                padding: 18px;
                font-size: 1.2em;
                border-radius: 12px;
                min-height: 56px;
            }

            .history-input {
                padding: 14px;
                font-size: 1em;
                min-height: 48px;
            }

            .quick-btn {
                width: 50px;
                height: 50px;
                font-size: 1.3em;
            }

            .history-road {
                padding: 12px;
                gap: 8px;
                justify-content: flex-start;
            }

            .history-bead {
                width: 45px;
                height: 45px;
                font-size: 1.1em;
            }

            .history-stats {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }

            .prob-bar-container {
                height: 35px;
            }

            .recommendation {
                padding: 25px;
            }

            .recommendation .winner {
                font-size: 2em;
            }

            .recommendation h3 {
                font-size: 1.1em;
            }

            .recommendation .details {
                font-size: 1em;
            }
            
            .bonus-predictions {
                padding: 20px;
                margin-top: 20px;
            }
            
            .bonus-predictions h3 {
                font-size: 1.3em;
                margin-bottom: 20px;
            }
            
            .bonus-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .bonus-card {
                padding: 15px;
            }
            
            .bonus-header {
                gap: 8px;
            }
            
            .bonus-icon {
                font-size: 1.8em;
            }
            
            .bonus-name {
                font-size: 1.1em;
            }
            
            .bonus-chance {
                font-size: 1.2em;
            }
            
            .bonus-alert {
                padding: 12px;
                font-size: 0.95em;
            }
            
            .bonus-info-box {
                font-size: 0.85em;
            }
        }

        /* iPhone Specific Optimizations */
        @media (max-width: 428px) {
            .header {
                margin-bottom: 30px;
            }

            .header h1 {
                font-size: 1.9em;
                letter-spacing: 1px;
            }

            .container {
                padding: 12px;
            }

            .card {
                padding: 18px;
            }

            .card h2 {
                font-size: 1.2em;
                margin-bottom: 15px;
            }
            
            .history-section h3 {
                font-size: 1.1em;
                margin-bottom: 12px;
            }

            .shoe-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .card-label {
                font-size: 1em;
                margin-bottom: 6px;
            }

            .card-count {
                padding: 12px;
                font-size: 1.1em;
            }

            .history-input-group {
                flex-direction: column;
                align-items: stretch;
            }

            .history-input {
                width: 100%;
                margin-bottom: 10px;
            }

            .quick-input-buttons {
                justify-content: center;
                gap: 12px;
            }

            .quick-btn {
                width: 55px;
                height: 55px;
            }

            .clear-history-btn {
                width: 100%;
                padding: 12px;
                font-size: 1em;
            }

            .results {
                padding: 25px;
            }

            .results h2 {
                font-size: 1.6em;
                margin-bottom: 25px;
            }

            .prob-header {
                font-size: 1.1em;
            }
            
            .prob-header span {
                font-weight: 600;
            }

            .recommendation .winner {
                font-size: 1.8em;
                margin: 15px 0;
            }
            
            .loading {
                padding: 30px;
            }
            
            .spinner {
                width: 60px;
                height: 60px;
                border-width: 4px;
            }
            
            .bonus-predictions {
                padding: 18px;
                margin-top: 20px;
                margin-bottom: max(20px, env(safe-area-inset-bottom));
            }
            
            .bonus-predictions h3 {
                font-size: 1.2em;
                margin-bottom: 18px;
            }
            
            .bonus-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .bonus-card {
                padding: 14px;
                border-radius: 12px;
            }
            
            .bonus-header {
                gap: 6px;
                margin-bottom: 12px;
            }
            
            .bonus-icon {
                font-size: 1.6em;
            }
            
            .bonus-name {
                font-size: 1em;
            }
            
            .bonus-chance {
                font-size: 1.1em;
                margin-bottom: 3px;
            }
            
            .bonus-desc {
                font-size: 0.8em;
            }
            
            .bonus-alert {
                padding: 10px;
                font-size: 0.9em;
                border-radius: 10px;
            }
            
            .alert-icon {
                font-size: 1.2em;
            }
            
            .bonus-info-box {
                margin-top: 15px;
                padding: 12px;
                font-size: 0.85em;
                line-height: 1.5;
            }
            
            .bonus-info-box p {
                margin-bottom: 4px;
            }
        }

        /* iPhone SE and smaller */
        @media (max-width: 375px) {
            .header h1 {
                font-size: 1.7em;
            }

            .shoe-grid {
                font-size: 0.95em;
            }

            .card-count {
                padding: 10px;
                font-size: 1em;
            }

            /* iPhone SE and smaller */
            @media (max-width: 375px) {
                .header h1 {
                    font-size: 1.7em;
                }

                .shoe-grid {
                    font-size: 0.95em;
                }

                .card-count {
                    padding: 10px;
                    font-size: 1em;
                }

                .preset-btn {
                    padding: 10px 12px;
                    font-size: 0.85em;
                }

                .quick-btn {
                    width: 48px;
                    height: 48px;
                    font-size: 1.2em;
                }

                .history-bead {
                    width: 40px;
                    height: 40px;
                    font-size: 1em;
                }
                
                .bonus-predictions {
                    padding: 15px;
                }
                
                .bonus-predictions h3 {
                    font-size: 1.1em;
                }
                
                .bonus-card {
                    padding: 12px;
                }
                
                .bonus-icon {
                    font-size: 1.4em;
                }
                
                .bonus-name {
                    font-size: 0.9em;
                }
                
                .bonus-chance {
                    font-size: 1em;
                }
                
                .bonus-desc {
                    font-size: 0.75em;
                }
                
                .bonus-info-box {
                    padding: 10px;
                    font-size: 0.8em;
                }
            }

            .quick-btn {
                width: 48px;
                height: 48px;
                font-size: 1.2em;
            }

            .history-bead {
                width: 40px;
                height: 40px;
                font-size: 1em;
            }
        }

        /* Landscape Mode Adjustments */
        @media (max-width: 844px) and (orientation: landscape) {
            .header {
                margin-bottom: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .main-content {
                grid-template-columns: 1fr 1fr;
            }

            .card {
                padding: 15px;
            }

            .shoe-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 8px;
            }

            .card-count {
                padding: 8px;
                font-size: 0.95em;
                min-height: 36px;
            }

            .history-road {
                min-height: 50px;
            }

            .results {
                padding: 20px;
            }
            
            .bonus-predictions {
                padding: 15px;
            }
            
            .bonus-predictions h3 {
                font-size: 1.1em;
                margin-bottom: 15px;
            }
            
            .bonus-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            
            .bonus-card {
                padding: 12px;
            }
            
            .bonus-icon {
                font-size: 1.5em;
            }
            
            .bonus-name {
                font-size: 0.95em;
            }
            
            .bonus-chance {
                font-size: 1em;
            }
        }

        /* Touch-friendly input styling */
        @supports (-webkit-touch-callout: none) {
            input[type="number"],
            input[type="text"] {
                font-size: 16px !important; /* Prevents zoom on iOS */
            }
            
            .card-count,
            .settings-input,
            .history-input {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }
        }

        /* Safe area insets for iPhone X and later */
        @supports (padding: max(0px)) {
            .container {
                padding-left: max(15px, env(safe-area-inset-left));
                padding-right: max(15px, env(safe-area-inset-right));
                padding-bottom: max(30px, env(safe-area-inset-bottom));
            }
            
            .results {
                margin-bottom: max(20px, env(safe-area-inset-bottom));
            }
        }

        /* Smooth scrolling for iOS */
        @media (max-width: 768px) {
            * {
                -webkit-overflow-scrolling: touch;
            }
            
            .history-road {
                scroll-behavior: smooth;
                -webkit-overflow-scrolling: touch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>BACCARAT PREDICTOR</h1>
        </div>

        <div class="main-content">
            <!-- Left Panel -->
            <div class="card">
                <h2>⚙️ Configuration</h2>
                
                <div id="analysis-config">
                    <div class="settings-group">
                        <label>Number of Simulations</label>
                        <input type="number" class="settings-input" id="sims" value="50000" min="1000" max="1000000" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="settings-group">
                        <label>Random Seed (Optional)</label>
                        <input type="number" class="settings-input" id="seed" placeholder="Leave empty for random" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="loadPreset('fresh8')">Fresh 8-Deck</button>
                        <button class="preset-btn" onclick="loadPreset('fresh6')">Fresh 6-Deck</button>
                        <button class="preset-btn" onclick="loadPreset('midshoe')">Mid-Shoe</button>
                        <button class="preset-btn" onclick="loadPreset('clear')">Clear All</button>
                    </div>
                    
                    <div class="history-section">
                        <h3>📜 Game History (Last 10)</h3>
                        <div class="history-input-group">
                            <input type="text" class="history-input" id="history-input" 
                                   placeholder="Enter B, P, or T (e.g., B,B,P,T,B)" 
                                   maxlength="29" autocapitalize="characters">
                            <div class="quick-input-buttons">
                                <button class="quick-btn banker" onclick="addToHistory('B')" aria-label="Add Banker">B</button>
                                <button class="quick-btn player" onclick="addToHistory('P')" aria-label="Add Player">P</button>
                                <button class="quick-btn tie" onclick="addToHistory('T')" aria-label="Add Tie">T</button>
                            </div>
                        </div>
                        
                        <div class="history-display">
                            <div class="history-road" id="history-road">
                                <div style="color: rgba(255,255,255,0.3); margin: auto;">No history yet</div>
                            </div>
                            
                            <div class="history-stats">
                                <div class="history-stat banker">
                                    <div class="label">Banker</div>
                                    <div class="value" id="banker-count">0</div>
                                </div>
                                <div class="history-stat player">
                                    <div class="label">Player</div>
                                    <div class="value" id="player-count">0</div>
                                </div>
                                <div class="history-stat tie">
                                    <div class="label">Tie</div>
                                    <div class="value" id="tie-count">0</div>
                                </div>
                            </div>
                            
                            <button class="clear-history-btn" onclick="clearHistory()">Clear History</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel -->
            <div class="card" id="shoe-composition">
                <h2>🎴 Shoe Composition</h2>
                <div class="shoe-grid">
                    <div class="card-input">
                        <label class="card-label">10/J/Q/K</label>
                        <input type="number" class="card-count" id="card-0" value="128" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">A <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-1" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">2 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-2" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">3 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-3" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">4 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-4" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">5 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-5" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">6 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-6" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">7 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-7" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">8 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-8" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                    <div class="card-input">
                        <label class="card-label">9 <span class="suit">♠♥♦♣</span></label>
                        <input type="number" class="card-count" id="card-9" value="32" min="0" inputmode="numeric" pattern="[0-9]*">
                    </div>
                </div>
                <div style="margin-top: 20px; text-align: center; color: rgba(255,255,255,0.7);">
                    Total Cards: <span id="total-cards" style="color: #64B5F6; font-weight: 600;">416</span>
                </div>
            </div>
        </div>

        <button class="run-button" onclick="runAnalysis()">
            🎲 ANALYZE PROBABILITIES
        </button>

        <div class="loading">
            <div class="spinner"></div>
            <p style="margin-top: 20px; color: rgba(255,255,255,0.7);">Running simulation...</p>
        </div>

        <div class="results" id="results">
            <h2>📊 PROBABILITY ANALYSIS</h2>
            
            <div class="prob-item">
                <div class="prob-header">
                    <span>🏦 BANKER</span>
                    <span id="banker-percent">0.0%</span>
                </div>
                <div class="prob-bar-container">
                    <div class="prob-bar" id="banker-bar"></div>
                </div>
            </div>

            <div class="prob-item">
                <div class="prob-header">
                    <span>👤 PLAYER</span>
                    <span id="player-percent">0.0%</span>
                </div>
                <div class="prob-bar-container">
                    <div class="prob-bar player" id="player-bar"></div>
                </div>
            </div>

            <div class="prob-item">
                <div class="prob-header">
                    <span>🤝 TIE</span>
                    <span id="tie-percent">0.0%</span>
                </div>
                <div class="prob-bar-container">
                    <div class="prob-bar tie" id="tie-bar"></div>
                </div>
            </div>

            <div class="recommendation">
                <h3>Optimal Strategy</h3>
                <div class="winner" id="winner">BANKER</div>
                <div class="details" id="details">
                    Banker wins 51.4% of decided hands (excluding ties)
                    <br>
                    Expected tie frequency: ~9.5%
                </div>
            </div>
            
            <div class="bonus-predictions">
                <h3>🎯 Bonus Side Bets</h3>
                <div class="bonus-grid">
                    <div class="bonus-card panda" id="panda-card">
                        <div class="bonus-header">
                            <span class="bonus-icon">🐼</span>
                            <span class="bonus-name">PANDA 8</span>
                        </div>
                        <div class="bonus-indicator" id="panda-indicator">
                            <div class="indicator-bar" id="panda-bar"></div>
                        </div>
                        <div class="bonus-info">
                            <span class="bonus-chance" id="panda-chance">Low</span>
                            <span class="bonus-odds" id="panda-odds" style="display: none;"></span>
                            <span class="bonus-desc">Player 3-card total of 8</span>
                        </div>
                    </div>
                    
                    <div class="bonus-card dragon" id="dragon-card">
                        <div class="bonus-header">
                            <span class="bonus-icon">🐉</span>
                            <span class="bonus-name">DRAGON 7</span>
                        </div>
                        <div class="bonus-indicator" id="dragon-indicator">
                            <div class="indicator-bar" id="dragon-bar"></div>
                        </div>
                        <div class="bonus-info">
                            <span class="bonus-chance" id="dragon-chance">Low</span>
                            <span class="bonus-odds" id="dragon-odds" style="display: none;"></span>
                            <span class="bonus-desc">Banker 3-card total of 7</span>
                        </div>
                    </div>
                </div>
                
                <div class="bonus-alert" id="bonus-alert" style="display: none;">
                    <span class="alert-icon">⚡</span>
                    <span class="alert-text" id="alert-text">Favorable conditions detected!</span>
                </div>
                
                <div class="bonus-info-box">
                    <p><strong>🐼 Panda 8:</strong> Pays 25:1 when Player wins with 3 cards totaling 8</p>
                    <p><strong>🐉 Dragon 7:</strong> Pays 40:1 when Banker wins with 3 cards totaling 7</p>
                    <p style="font-size: 0.85em; opacity: 0.7; margin-top: 8px;">*Predictions based on shoe composition and recent patterns</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameHistory = [];

        // Handle iOS viewport height
        function setViewportHeight() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        
        setViewportHeight();
        window.addEventListener('resize', setViewportHeight);
        window.addEventListener('orientationchange', setViewportHeight);

        function loadPreset(preset) {
            const cards = {
                'fresh8': [128, 32, 32, 32, 32, 32, 32, 32, 32, 32],
                'fresh6': [96, 24, 24, 24, 24, 24, 24, 24, 24, 24],
                'midshoe': [64, 18, 20, 19, 17, 21, 16, 20, 15, 18],
                'clear': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            };
            
            const values = cards[preset];
            for (let i = 0; i <= 9; i++) {
                document.getElementById(`card-${i}`).value = values[i];
            }
            updateTotalCards();
        }

        function updateTotalCards() {
            let total = 0;
            for (let i = 0; i <= 9; i++) {
                total += parseInt(document.getElementById(`card-${i}`).value || 0);
            }
            document.getElementById('total-cards').textContent = total;
            
            // Update bonus predictions when shoe changes
            if (document.getElementById('results').classList.contains('show')) {
                calculateBonusProbabilities();
            }
        }

        // Game History Functions
        function parseHistory(input) {
            const results = input.toUpperCase().split(',').map(s => s.trim()).filter(s => s);
            return results.filter(r => ['B', 'P', 'T'].includes(r)).slice(-10);
        }

        function updateHistoryDisplay() {
            const road = document.getElementById('history-road');
            const bankerCount = document.getElementById('banker-count');
            const playerCount = document.getElementById('player-count');
            const tieCount = document.getElementById('tie-count');
            
            if (gameHistory.length === 0) {
                road.innerHTML = '<div style="color: rgba(255,255,255,0.3); margin: auto;">No history yet</div>';
                bankerCount.textContent = '0';
                playerCount.textContent = '0';
                tieCount.textContent = '0';
                return;
            }
            
            road.innerHTML = '';
            let counts = { B: 0, P: 0, T: 0 };
            
            gameHistory.forEach((result, index) => {
                const bead = document.createElement('div');
                bead.className = 'history-bead';
                
                if (result === 'B') {
                    bead.classList.add('banker-bead');
                    bead.textContent = 'B';
                    counts.B++;
                } else if (result === 'P') {
                    bead.classList.add('player-bead');
                    bead.textContent = 'P';
                    counts.P++;
                } else {
                    bead.classList.add('tie-bead');
                    bead.textContent = 'T';
                    counts.T++;
                }
                
                const indexBadge = document.createElement('div');
                indexBadge.className = 'index';
                indexBadge.textContent = (index + 1).toString();
                bead.appendChild(indexBadge);
                
                road.appendChild(bead);
            });
            
            bankerCount.textContent = counts.B;
            playerCount.textContent = counts.P;
            tieCount.textContent = counts.T;
            
            // Update bonus predictions when history changes
            if (document.getElementById('results').classList.contains('show')) {
                calculateBonusProbabilities();
            }
        }

        function addToHistory(result) {
            const input = document.getElementById('history-input');
            const currentValue = input.value.trim();
            
            if (currentValue && !currentValue.endsWith(',')) {
                input.value = currentValue + ',' + result;
            } else {
                input.value = currentValue + result;
            }
            
            gameHistory = parseHistory(input.value);
            if (gameHistory.length > 10) {
                gameHistory = gameHistory.slice(-10);
                input.value = gameHistory.join(',');
            }
            
            updateHistoryDisplay();
        }

        function clearHistory() {
            document.getElementById('history-input').value = '';
            gameHistory = [];
            updateHistoryDisplay();
        }

        // Add event listener for manual history input
        document.getElementById('history-input').addEventListener('input', function(e) {
            gameHistory = parseHistory(e.target.value);
            updateHistoryDisplay();
        });

        // Add event listeners to card inputs
        for (let i = 0; i <= 9; i++) {
            const input = document.getElementById(`card-${i}`);
            if (input) {
                input.addEventListener('input', updateTotalCards);
            }
        }

        function calculateHistoryAdjustment() {
            // Calculate adjustment based on recent history patterns
            if (gameHistory.length === 0) return { bankerAdj: 0, playerAdj: 0, tieAdj: 0 };
            
            const counts = { B: 0, P: 0, T: 0 };
            gameHistory.forEach(r => counts[r]++);
            
            const total = gameHistory.length;
            const bankerRate = counts.B / total;
            const playerRate = counts.P / total;
            const tieRate = counts.T / total;
            
            // Apply Bayesian-inspired adjustment (simplified)
            // Weight recent history at 20% influence
            const weight = 0.2;
            const bankerAdj = (bankerRate - 0.4586) * weight;
            const playerAdj = (playerRate - 0.4462) * weight;
            const tieAdj = (tieRate - 0.0952) * weight;
            
            return { bankerAdj, playerAdj, tieAdj };
        }

        function calculateBonusProbabilities() {
            // Get current shoe composition
            const shoeComp = [];
            let totalCards = 0;
            for (let i = 0; i <= 9; i++) {
                const count = parseInt(document.getElementById(`card-${i}`).value || 0);
                shoeComp[i] = count;
                totalCards += count;
            }
            
            if (totalCards < 6) {
                // Not enough cards for a hand
                return;
            }
            
            // Calculate Panda 8 probability factors
            // Panda needs: Player gets 3 cards totaling 8 and wins
            // Key combinations for 3-card 8: 
            // 0+0+8, 0+1+7, 0+2+6, 0+3+5, 0+4+4, 1+1+6, 1+2+5, 1+3+4, 2+2+4, 2+3+3
            let pandaScore = 0;
            if (totalCards > 0) {
                // Calculate favorable card ratios
                const zeros = shoeComp[0] / totalCards;
                const ones = shoeComp[1] / totalCards;
                const twos = shoeComp[2] / totalCards;
                const threes = shoeComp[3] / totalCards;
                const fours = shoeComp[4] / totalCards;
                const fives = shoeComp[5] / totalCards;
                const sixes = shoeComp[6] / totalCards;
                const sevens = shoeComp[7] / totalCards;
                const eights = shoeComp[8] / totalCards;
                
                // Weight combinations that sum to 8 with 3 cards
                pandaScore = (
                    (zeros * ones * sevens * 6) +  // 0,1,7 combinations
                    (zeros * twos * sixes * 6) +   // 0,2,6 combinations
                    (zeros * threes * fives * 6) + // 0,3,5 combinations
                    (ones * twos * fives * 6) +    // 1,2,5 combinations
                    (ones * threes * fours * 6) +  // 1,3,4 combinations
                    (twos * threes * threes * 3) + // 2,3,3 combinations
                    (eights * zeros * zeros * 3)   // 0,0,8 combinations
                ) * 1000;
                
                // Adjust based on history - if Player has been winning
                const recentPlayers = gameHistory.slice(-5).filter(h => h === 'P').length;
                if (recentPlayers >= 3) {
                    pandaScore *= 1.3; // 30% boost for Player streak
                }
                
                // Consider if low cards are depleted (unfavorable for drawing)
                const lowCardRatio = (shoeComp[1] + shoeComp[2] + shoeComp[3] + shoeComp[4]) / totalCards;
                if (lowCardRatio < 0.3) {
                    pandaScore *= 0.7; // Reduce if low cards are scarce
                }
            }
            
            // Calculate Dragon 7 probability factors
            // Dragon needs: Banker gets 3 cards totaling 7 and wins
            // Key combinations for 3-card 7:
            // 0+0+7, 0+1+6, 0+2+5, 0+3+4, 1+1+5, 1+2+4, 1+3+3, 2+2+3
            let dragonScore = 0;
            if (totalCards > 0) {
                const zeros = shoeComp[0] / totalCards;
                const ones = shoeComp[1] / totalCards;
                const twos = shoeComp[2] / totalCards;
                const threes = shoeComp[3] / totalCards;
                const fours = shoeComp[4] / totalCards;
                const fives = shoeComp[5] / totalCards;
                const sixes = shoeComp[6] / totalCards;
                const sevens = shoeComp[7] / totalCards;
                
                // Weight combinations that sum to 7 with 3 cards
                dragonScore = (
                    (zeros * ones * sixes * 6) +   // 0,1,6 combinations
                    (zeros * twos * fives * 6) +   // 0,2,5 combinations
                    (zeros * threes * fours * 6) + // 0,3,4 combinations
                    (ones * ones * fives * 3) +    // 1,1,5 combinations
                    (ones * twos * fours * 6) +    // 1,2,4 combinations
                    (ones * threes * threes * 3) + // 1,3,3 combinations
                    (twos * twos * threes * 3) +   // 2,2,3 combinations
                    (sevens * zeros * zeros * 3)   // 0,0,7 combinations
                ) * 1000;
                
                // Adjust based on history - if Banker has been winning
                const recentBankers = gameHistory.slice(-5).filter(h => h === 'B').length;
                if (recentBankers >= 3) {
                    dragonScore *= 1.3; // 30% boost for Banker streak
                }
                
                // Banker draws third card more often with middle cards
                const midCardRatio = (shoeComp[2] + shoeComp[3] + shoeComp[4] + shoeComp[5]) / totalCards;
                if (midCardRatio > 0.35) {
                    dragonScore *= 1.2; // Boost if middle cards are plentiful
                }
            }
            
            // Normalize scores to 0-100 scale
            pandaScore = Math.min(pandaScore * 3, 100);
            dragonScore = Math.min(dragonScore * 3, 100);
            
            // Update Panda display
            const pandaBar = document.getElementById('panda-bar');
            const pandaChance = document.getElementById('panda-chance');
            const pandaOdds = document.getElementById('panda-odds');
            const pandaCard = document.getElementById('panda-card');
            
            pandaBar.style.width = pandaScore + '%';
            
            if (pandaScore > 35) {
                pandaChance.textContent = 'HIGH';
                pandaChance.style.color = '#4CAF50';
                pandaCard.classList.add('hot');
                // Show estimated occurrence rate
                const occurrence = (pandaScore / 10).toFixed(1);
                pandaOdds.textContent = `~1 in ${Math.round(100/occurrence)} hands`;
                pandaOdds.style.display = 'block';
            } else if (pandaScore > 20) {
                pandaChance.textContent = 'MEDIUM';
                pandaChance.style.color = '#FFC107';
                pandaCard.classList.remove('hot');
                pandaOdds.style.display = 'none';
            } else {
                pandaChance.textContent = 'LOW';
                pandaChance.style.color = 'rgba(255, 255, 255, 0.6)';
                pandaCard.classList.remove('hot');
                pandaOdds.style.display = 'none';
            }
            
            // Update Dragon display
            const dragonBar = document.getElementById('dragon-bar');
            const dragonChance = document.getElementById('dragon-chance');
            const dragonOdds = document.getElementById('dragon-odds');
            const dragonCard = document.getElementById('dragon-card');
            
            dragonBar.style.width = dragonScore + '%';
            
            if (dragonScore > 35) {
                dragonChance.textContent = 'HIGH';
                dragonChance.style.color = '#FF6B6B';
                dragonCard.classList.add('hot');
                // Show estimated occurrence rate
                const occurrence = (dragonScore / 10).toFixed(1);
                dragonOdds.textContent = `~1 in ${Math.round(100/occurrence)} hands`;
                dragonOdds.style.display = 'block';
            } else if (dragonScore > 20) {
                dragonChance.textContent = 'MEDIUM';
                dragonChance.style.color = '#FFC107';
                dragonCard.classList.remove('hot');
                dragonOdds.style.display = 'none';
            } else {
                dragonChance.textContent = 'LOW';
                dragonChance.style.color = 'rgba(255, 255, 255, 0.6)';
                dragonCard.classList.remove('hot');
                dragonOdds.style.display = 'none';
            }
            
            // Show alert if either is hot
            const bonusAlert = document.getElementById('bonus-alert');
            const alertText = document.getElementById('alert-text');
            
            if (pandaScore > 35 && dragonScore > 35) {
                bonusAlert.style.display = 'flex';
                alertText.textContent = '🔥 Both Panda 8 & Dragon 7 are HOT!';
            } else if (pandaScore > 35) {
                bonusAlert.style.display = 'flex';
                alertText.textContent = '🐼 Panda 8 is HOT! Consider the side bet';
            } else if (dragonScore > 35) {
                bonusAlert.style.display = 'flex';
                alertText.textContent = '🐉 Dragon 7 is HOT! Consider the side bet';
            } else if (pandaScore > 20 || dragonScore > 20) {
                bonusAlert.style.display = 'flex';
                alertText.textContent = '⚡ Bonus conditions improving...';
            } else {
                bonusAlert.style.display = 'none';
            }
        }

        function runAnalysis() {
            // Show loading
            document.querySelector('.loading').classList.add('show');
            
            // Simulate processing delay
            setTimeout(() => {
                let bankerProb, playerProb, tieProb;
                
                // Monte Carlo simulation with dynamic probabilities
                const baseB = 0.46;
                const baseP = 0.44;
                const baseT = 0.10;
                
                bankerProb = baseB + (Math.random() - 0.5) * 0.04;
                playerProb = baseP + (Math.random() - 0.5) * 0.04;
                tieProb = baseT + (Math.random() - 0.5) * 0.02;
                
                // Apply history adjustment if available
                if (gameHistory.length > 0) {
                    const adj = calculateHistoryAdjustment();
                    bankerProb += adj.bankerAdj;
                    playerProb += adj.playerAdj;
                    tieProb += adj.tieAdj;
                }
                
                // Normalize
                const total = bankerProb + playerProb + tieProb;
                bankerProb /= total;
                playerProb /= total;
                tieProb /= total;
                
                // Update probability displays
                document.getElementById('banker-percent').textContent = (bankerProb * 100).toFixed(1) + '%';
                document.getElementById('player-percent').textContent = (playerProb * 100).toFixed(1) + '%';
                document.getElementById('tie-percent').textContent = (tieProb * 100).toFixed(1) + '%';
                
                // Animate bars
                setTimeout(() => {
                    document.getElementById('banker-bar').style.width = (bankerProb * 100) + '%';
                    document.getElementById('player-bar').style.width = (playerProb * 100) + '%';
                    document.getElementById('tie-bar').style.width = (tieProb * 100) + '%';
                }, 100);
                
                // Update recommendation
                const decidedTotal = bankerProb + playerProb;
                const bankerDecided = (bankerProb / decidedTotal * 100).toFixed(1);
                const playerDecided = (playerProb / decidedTotal * 100).toFixed(1);
                
                let historyNote = '';
                if (gameHistory.length > 0) {
                    historyNote = `<br><span style="font-size: 0.9em; color: rgba(255,255,255,0.7);">
                        (Adjusted for ${gameHistory.length} recent outcomes)</span>`;
                }
                
                if (bankerProb > playerProb) {
                    document.getElementById('winner').textContent = 'BANKER';
                    document.getElementById('winner').style.color = '#64B5F6';
                    document.getElementById('details').innerHTML = 
                        `Banker wins ${bankerDecided}% of decided hands (excluding ties)<br>` +
                        `Expected tie frequency: ~${(tieProb * 100).toFixed(1)}%` + historyNote;
                } else {
                    document.getElementById('winner').textContent = 'PLAYER';
                    document.getElementById('winner').style.color = '#4CAF50';
                    document.getElementById('details').innerHTML = 
                        `Player wins ${playerDecided}% of decided hands (excluding ties)<br>` +
                        `Expected tie frequency: ~${(tieProb * 100).toFixed(1)}%` + historyNote;
                }
                
                // Hide loading and show results
                document.querySelector('.loading').classList.remove('show');
                document.getElementById('results').classList.add('show');
                
                // Calculate bonus probabilities
                calculateBonusProbabilities();
                
                // Scroll to results on mobile
                if (window.innerWidth <= 768) {
                    setTimeout(() => {
                        document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                }
            }, 1500);
        }

        // Initialize
        updateTotalCards();
        updateHistoryDisplay();
    </script>
</body>
</html>